(window.webpackJsonp=window.webpackJsonp||[]).push([[472],{936:function(s,a,t){"use strict";t.r(a);var n=t(11),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"调试排错---java问题排查：工具单"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#调试排错---java问题排查：工具单"}},[s._v("¶")]),s._v(" 调试排错 - Java问题排查：工具单 "),t("Badge",{attrs:{text:"New"}})],1),s._v(" "),t("blockquote",[t("p",[s._v("Java 在线问题排查主要分两篇：本文是第二篇，通过java调试/排查工具进行问题定位。@pdai")])]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#%E8%B0%83%E8%AF%95%E6%8E%92%E9%94%99---java%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%E5%B7%A5%E5%85%B7%E5%8D%95-badge-textnew-"}},[s._v("调试排错 - Java问题排查：工具单 "),t("Badge",{attrs:{text:"New"}})],1),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#java-%E8%B0%83%E8%AF%95%E5%85%A5%E9%97%A8%E5%B7%A5%E5%85%B7"}},[s._v("Java 调试入门工具")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#jps"}},[s._v("jps")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#jstack"}},[s._v("jstack")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#jinfo"}},[s._v("jinfo")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#jmap"}},[s._v("jmap")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#jstat"}},[s._v("jstat")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#jdb"}},[s._v("jdb")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#chlsdb"}},[s._v("CHLSDB")])])])]),s._v(" "),t("li",[t("a",{attrs:{href:"#java-%E8%B0%83%E8%AF%95%E8%BF%9B%E9%98%B6%E5%B7%A5%E5%85%B7"}},[s._v("Java 调试进阶工具")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#btrace"}},[s._v("btrace")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#greys"}},[s._v("Greys")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#arthas"}},[s._v("Arthas")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#javosize"}},[s._v("javOSize")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#jprofiler"}},[s._v("JProfiler")])])])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%85%B6%E5%AE%83%E5%B7%A5%E5%85%B7"}},[s._v("其它工具")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#dmesg"}},[s._v("dmesg")])])])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"}},[s._v("参考文章")])])])])]),s._v(" "),t("h2",{attrs:{id:"java-调试入门工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#java-调试入门工具"}},[s._v("¶")]),s._v(" Java 调试入门工具")]),s._v(" "),t("h3",{attrs:{id:"jps"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jps"}},[s._v("¶")]),s._v(" jps")]),s._v(" "),t("blockquote",[t("p",[s._v("jps是jdk提供的一个查看当前java进程的小工具， 可以看做是JavaVirtual Machine Process Status Tool的缩写。")])]),s._v(" "),t("p",[s._v("jps常用命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("jps "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示进程的ID 和 类的名称")]),s._v("\njps –l "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出输出完全的包名，应用主类名，jar的完全路径名 ")]),s._v("\njps –v "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出jvm参数")]),s._v("\njps –q "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示java进程号")]),s._v("\njps -m "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# main 方法")]),s._v("\njps -l xxx.xxx.xx.xx "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 远程查看 ")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("jps参数")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("-q：仅输出VM标识符，不包括classname,jar name,arguments "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" main method \n-m：输出main method的参数 \n-l：输出完全的包名，应用主类名，jar的完全路径名 \n-v：输出jvm参数 \n-V：输出通过flag文件传递到JVM中的参数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(".hotspotrc文件或-XX:Flags"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("所指定的文件 \n-Joption：传递参数到vm,例如:-J-Xms512m\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("jps原理")]),s._v(" "),t("blockquote",[t("p",[s._v("java程序在启动以后，会在java.io.tmpdir指定的目录下，就是临时文件夹里，生成一个类似于hsperfdata_User的文件夹，这个文件夹里（在Linux中为/tmp/hsperfdata_{userName}/），有几个文件，名字就是java进程的pid，因此列出当前运行的java进程，只是把这个目录里的文件名列一下而已。 至于系统的参数什么，就可以解析这几个文件获得。")])]),s._v(" "),t("p",[s._v("更多请参考 "),t("a",{attrs:{href:"https://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jps.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("jps - Java Virtual Machine Process Status Tool"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"jstack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jstack"}},[s._v("¶")]),s._v(" jstack")]),s._v(" "),t("blockquote",[t("p",[s._v("jstack是jdk自带的线程堆栈分析工具，使用该命令可以查看或导出 Java 应用程序中线程堆栈信息。")])]),s._v(" "),t("p",[s._v("jstack常用命令:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基本")]),s._v("\njstack "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# java和native c/c++框架的所有栈信息")]),s._v("\njstack -m "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 额外的锁信息列表，查看是否死锁")]),s._v("\njstack -l "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("jstack参数：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("-l 长列表. 打印关于锁的附加信息,例如属于java.util.concurrent 的 ownable synchronizers列表.\n\n-F 当’jstack "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-l"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" pid’没有相应的时候强制打印栈信息\n\n-m 打印java和native c/c++框架的所有栈信息.\n\n-h "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" -help 打印帮助信息\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("更多请参考: "),t("a",{attrs:{href:"https://www.jianshu.com/p/025cb069cb69",target:"_blank",rel:"noopener noreferrer"}},[s._v("jvm 性能调优工具之 jstack"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"jinfo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jinfo"}},[s._v("¶")]),s._v(" jinfo")]),s._v(" "),t("blockquote",[t("p",[s._v("jinfo 是 JDK 自带的命令，可以用来查看正在运行的 java 应用程序的扩展参数，包括Java System属性和JVM命令行参数；也可以动态的修改正在运行的 JVM 一些参数。当系统崩溃时，jinfo可以从core文件里面知道崩溃的Java应用程序的配置信息")])]),s._v(" "),t("p",[s._v("jinfo常用命令:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出当前 jvm 进程的全部参数和系统属性")]),s._v("\njinfo "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出所有的参数")]),s._v("\njinfo -flags "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看指定的 jvm 参数的值")]),s._v("\njinfo -flag PrintGC "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启/关闭指定的JVM参数")]),s._v("\njinfo -flag +PrintGC "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置flag的参数")]),s._v("\njinfo -flag "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出当前 jvm 进行的全部的系统属性")]),s._v("\njinfo -sysprops "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("jinfo参数：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("no option 输出全部的参数和系统属性\n-flag name 输出对应名称的参数\n-flag "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("+"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("name 开启或者关闭对应名称的参数\n-flag "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("value 设定对应名称的参数\n-flags 输出全部的参数\n-sysprops 输出系统属性\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("更多请参考："),t("a",{attrs:{href:"https://www.jianshu.com/p/8d8aef212b25",target:"_blank",rel:"noopener noreferrer"}},[s._v("jvm 性能调优工具之 jinfo"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"jmap"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jmap"}},[s._v("¶")]),s._v(" jmap")]),s._v(" "),t("blockquote",[t("p",[s._v("命令jmap是一个多功能的命令。它可以生成 java 程序的 dump 文件， 也可以查看堆内对象示例的统计信息、查看 ClassLoader 的信息以及 finalizer 队列。")])]),s._v(" "),t("p",[s._v("两个用途")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看堆的情况")]),s._v("\njmap -heap "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dump")]),s._v("\njmap -dump:live,format"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b,file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/heap2.bin "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\njmap -dump:format"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b,file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/heap3.bin "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看堆的占用")]),s._v("\njmap -histo "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("head")]),s._v(" -10\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("jmap参数")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("no option： 查看进程的内存映像信息,类似 Solaris pmap 命令。\nheap： 显示Java堆详细信息\nhisto"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":live"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("： 显示堆中对象的统计信息\nclstats：打印类加载器信息\nfinalizerinfo： 显示在F-Queue队列等待Finalizer线程执行finalizer方法的对象\ndump:"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("dump-options"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("：生成堆转储快照\nF： 当-dump没有响应时，使用-dump或者-histo参数. 在这个模式下,live子参数无效.\nhelp：打印帮助信息\nJ"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("flag"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("：指定传递给运行jmap的JVM的参数\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("更多请参考："),t("a",{attrs:{href:"https://www.jianshu.com/p/a4ad53179df3",target:"_blank",rel:"noopener noreferrer"}},[s._v("jvm 性能调优工具之 jmap"),t("OutboundLink")],1),s._v(" 和 "),t("a",{attrs:{href:"https://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jmap.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("jmap - Memory Map"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"jstat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jstat"}},[s._v("¶")]),s._v(" jstat")]),s._v(" "),t("p",[s._v("jstat参数众多，但是使用一个就够了")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("jstat -gcutil "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"jdb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jdb"}},[s._v("¶")]),s._v(" jdb")]),s._v(" "),t("p",[s._v("jdb可以用来预发debug,假设你预发的java_home是/opt/java/，远程调试端口是8000.那么")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("jdb -attach "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("出现以上代表jdb启动成功。后续可以进行设置断点进行调试。")]),s._v(" "),t("p",[s._v("具体参数可见oracle官方说明"),t("a",{attrs:{href:"http://docs.oracle.com/javase/7/docs/technotes/tools/windows/jdb.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("jdb - The Java Debugger"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"chlsdb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#chlsdb"}},[s._v("¶")]),s._v(" CHLSDB")]),s._v(" "),t("p",[s._v("CHLSDB感觉很多情况下可以看到更好玩的东西，不详细叙述了。 查询资料听说jstack和jmap等工具就是基于它的。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("java -classpath /opt/taobao/java/lib/sa-jdi.jar sun.jvm.hotspot.CLHSDB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("更详细的可见R大此贴\nhttp://rednaxelafx.iteye.com/blog/1847971")]),s._v(" "),t("h2",{attrs:{id:"java-调试进阶工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#java-调试进阶工具"}},[s._v("¶")]),s._v(" Java 调试进阶工具")]),s._v(" "),t("h3",{attrs:{id:"btrace"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#btrace"}},[s._v("¶")]),s._v(" btrace")]),s._v(" "),t("p",[s._v("首当其冲的要说的是btrace。真是生产环境&预发的排查问题大杀器。 简介什么的就不说了。直接上代码干")]),s._v(" "),t("ul",[t("li",[s._v("查看当前谁调用了ArrayList的add方法，同时只打印当前ArrayList的size大于500的线程调用栈")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@OnMethod")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("clazz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java.util.ArrayList"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"add"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Location")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CALL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" clazz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/./"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/./"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("m")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@ProbeClassName")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" probeClass"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@ProbeMethodName")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" probeMethod"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TargetInstance")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TargetMethodOrField")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" method"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getInt")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("field")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java.util.ArrayList"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"size"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("479")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"check who ArrayList.add method:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" probeClass "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" probeMethod  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", method:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" method "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", size:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getInt")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("field")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java.util.ArrayList"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"size"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("jstack")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"==========================="')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("ul",[t("li",[s._v("监控当前服务方法被调用时返回的值以及请求的参数")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@OnMethod")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("clazz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.taobao.sellerhome.transfer.biz.impl.C2CApplyerServiceImpl"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nav"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Location")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("RETURN"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" userId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" current"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" relation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" check"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" redirectUrl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AnyType")]),s._v(" result"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"parameter# userId:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" userId "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", current:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" current "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", relation:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" relation "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", check:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" check "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", redirectUrl:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" redirectUrl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", result:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" result"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("btrace 具体可以参考这里：https://github.com/btraceio/btrace")]),s._v(" "),t("p",[s._v("注意:")]),s._v(" "),t("ul",[t("li",[s._v("经过观察，1.3.9的release输出不稳定，要多触发几次才能看到正确的结果")]),s._v(" "),t("li",[s._v("正则表达式匹配trace类时范围一定要控制，否则极有可能出现跑满CPU导致应用卡死的情况")]),s._v(" "),t("li",[s._v("由于是字节码注入的原理，想要应用恢复到正常情况，需要重启应用。")])]),s._v(" "),t("h3",{attrs:{id:"greys"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#greys"}},[s._v("¶")]),s._v(" Greys")]),s._v(" "),t("p",[s._v("Greys是@杜琨的大作吧。说几个挺棒的功能(部分功能和btrace重合):")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("sc -df xxx")]),s._v(": 输出当前类的详情,包括源码位置和classloader结构")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("trace class method")]),s._v(": 打印出当前方法调用的耗时情况，细分到每个方法, 对排查方法性能时很有帮助。")])])]),s._v(" "),t("h3",{attrs:{id:"arthas"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#arthas"}},[s._v("¶")]),s._v(" Arthas")]),s._v(" "),t("blockquote",[t("p",[s._v("Arthas是基于Greys。")])]),s._v(" "),t("p",[s._v("具体请参考："),t("RouterLink",{attrs:{to:"/md/java/jvm/java-jvm-agent-arthas.html"}},[s._v("调试排错 - Java应用在线调试Arthas")])],1),s._v(" "),t("h3",{attrs:{id:"javosize"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#javosize"}},[s._v("¶")]),s._v(" javOSize")]),s._v(" "),t("p",[s._v("就说一个功能:")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("classes")]),s._v("：通过修改了字节码，改变了类的内容，即时生效。 所以可以做到快速的在某个地方打个日志看看输出，缺点是对代码的侵入性太大。但是如果自己知道自己在干嘛，的确是不错的玩意儿。")])]),s._v(" "),t("p",[s._v("其他功能Greys和btrace都能很轻易做的到，不说了。")]),s._v(" "),t("p",[s._v("更多请参考："),t("a",{attrs:{href:"http://www.javosize.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"jprofiler"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jprofiler"}},[s._v("¶")]),s._v(" JProfiler")]),s._v(" "),t("p",[s._v("之前判断许多问题要通过JProfiler，但是现在Greys和btrace基本都能搞定了。再加上出问题的基本上都是生产环境(网络隔离)，所以基本不怎么使用了，但是还是要标记一下。")]),s._v(" "),t("p",[s._v("更多请参考："),t("a",{attrs:{href:"https://www.ej-technologies.com/products/jprofiler/overview.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"其它工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其它工具"}},[s._v("¶")]),s._v(" 其它工具")]),s._v(" "),t("h3",{attrs:{id:"dmesg"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dmesg"}},[s._v("¶")]),s._v(" dmesg")]),s._v(" "),t("p",[s._v("如果发现自己的java进程悄无声息的消失了，几乎没有留下任何线索，那么dmesg一发，很有可能有你想要的。")]),s._v(" "),t("p",[s._v("sudo dmesg|grep -i kill|less\n去找关键字oom_killer。找到的结果类似如下:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6710782.021013")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" java invoked oom-killer: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gfp_mask")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xd0, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("order")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("oom_adj")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("oom_scoe_adj")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6710782.070639")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("ffffffff8111889"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("8")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ? oom_kill_process+0x68/0x140 \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6710782.257588")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Task "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /LXC011175068174 killed as a result of limit of /LXC011175068174 \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6710784.698347")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Memory cgroup out of memory: Kill process "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("215701")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("java"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" score "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("854")]),s._v(" or sacrifice child \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6710784.707978")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Killed process "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("215701")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("679")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("java"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" total-vm:11017300kB, anon-rss:7152432kB, file-rss:1232kB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("以上表明，对应的java进程被系统的OOM Killer给干掉了，得分为854.\n解释一下OOM killer（Out-Of-Memory killer），该机制会监控机器的内存资源消耗。当机器内存耗尽前，该机制会扫描所有的进程（按照一定规则计算，内存占用，时间等），挑选出得分最高的进程，然后杀死，从而保护机器。")]),s._v(" "),t("p",[s._v("dmesg日志时间转换公式:\nlog实际时间=格林威治1970-01-01+(当前时间秒数-系统启动至今的秒数+dmesg打印的log时间)秒数：")]),s._v(" "),t("p",[s._v('date -d "1970-01-01 UTC '),t("code",[s._v("echo \"$(date +%s)-$(cat /proc/uptime|cut -f 1 -d' ')+12288812.926194\"|bc")]),s._v(' seconds"\n剩下的，就是看看为什么内存这么大，触发了OOM-Killer了。')]),s._v(" "),t("h2",{attrs:{id:"参考文章"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[s._v("¶")]),s._v(" 参考文章")]),s._v(" "),t("ul",[t("li",[s._v("文章主要参考了如下， 在此基础上重新整理，和添加新内容。")]),s._v(" "),t("li",[s._v("作者：红魔七号")]),s._v(" "),t("li",[s._v("文章来源：https://yq.aliyun.com/articles/69520")]),s._v(" "),t("li",[s._v("https://www.cnblogs.com/xuchunlin/p/5671572.html")])])])}),[],!1,null,null,null);a.default=e.exports}}]);