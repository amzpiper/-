(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{629:function(s,a,t){"use strict";t.r(a);var n=t(11),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"es详解---安装：elasticsearch和kibana安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#es详解---安装：elasticsearch和kibana安装"}},[s._v("¶")]),s._v(" ES详解 - 安装：ElasticSearch和Kibana安装")]),s._v(" "),t("blockquote",[t("p",[s._v("了解完ElasticSearch基础和Elastic Stack生态后，我们便可以开始学习使用ElastiSearch了。所以本文主要介绍ElasticSearch和Kibana的安装。@pdai")])]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#es%E8%AF%A6%E8%A7%A3---%E5%AE%89%E8%A3%85elasticsearch%E5%92%8Ckibana%E5%AE%89%E8%A3%85"}},[s._v("ES详解 - 安装：ElasticSearch和Kibana安装")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#%E5%AE%98%E7%BD%91%E7%9B%B8%E5%85%B3%E6%95%99%E7%A8%8B"}},[s._v("官网相关教程")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%AE%89%E8%A3%85elasticsearch"}},[s._v("安装ElasticSearch")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%AE%89%E8%A3%85kibana"}},[s._v("安装Kibana")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E9%85%8D%E7%BD%AE%E5%AF%86%E7%A0%81%E8%AE%BF%E9%97%AE"}},[s._v("配置密码访问")])])])])]),s._v(" "),t("h2",{attrs:{id:"官网相关教程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#官网相关教程"}},[s._v("¶")]),s._v(" 官网相关教程")]),s._v(" "),t("blockquote",[t("p",[s._v("安装ElasticSearch还是先要看下官方网站。")])]),s._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://www.elastic.co/cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方网站"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.elastic.co/guide/cn/elasticsearch/guide/current/running-elasticsearch.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方2.x中文教程中安装教程"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.elastic.co/cn/downloads/elasticsearch",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方ElasticSearch下载地址"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.elastic.co/cn/downloads/kibana",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方Kibana下载地址"),t("OutboundLink")],1)])])]),s._v(" "),t("p",[s._v("本系列教程基于ElasticSearch 7.x版本。")]),s._v(" "),t("h2",{attrs:{id:"安装elasticsearch"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装elasticsearch"}},[s._v("¶")]),s._v(" 安装ElasticSearch")]),s._v(" "),t("blockquote",[t("p",[s._v("ElasticSearch 是基于Java平台的，所以先要安装Java")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("平台确认")])])]),s._v(" "),t("p",[s._v("这里我准备了一台Centos7虚拟机, 为方便选择后续安装的版本，所以需要看下系统版本信息。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uname -a")]),s._v("\nLinux VM-0-14-centos "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),s._v(".0-862.el7.x86_64 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1 SMP Fri Apr 20 16:44:24 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("安装Java")])])]),s._v(" "),t("p",[s._v("安装 Elasticsearch 之前，你需要先安装一个较新的版本的 Java，最好的选择是，你可以从 "),t("a",{attrs:{href:"http://www.java.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("www.java.com"),t("OutboundLink")],1),s._v(" 获得官方提供的最新版本的 Java。安装以后，确认是否安装成功：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# java --version")]),s._v("\nopenjdk "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.0")]),s._v(".2 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-07-14\nOpenJDK Runtime Environment "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("slowdebug build "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.0")]),s._v(".2+12"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nOpenJDK "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("-Bit Server VM "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("slowdebug build "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.0")]),s._v(".2+12, mixed mode, sharing"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("下载ElasticSearch")])])]),s._v(" "),t("p",[s._v("从"),t("a",{attrs:{href:"https://www.elastic.co/cn/downloads/elasticsearch",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),t("OutboundLink")],1),s._v("下载ElasticSearch")]),s._v(" "),t("p",[s._v("比如可以通过curl下载")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl -O https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.12.0-linux-x86_64.tar.gz")]),s._v("\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("解压")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar zxvf /opt/elasticsearch-7.12.0-linux-x86_64.tar.gz ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll | grep elasticsearch")]),s._v("\ndrwxr-xr-x  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" root root      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Mar "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":21 elasticsearch-7.12.0\n-rw-r--r--  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("327497331")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":05 elasticsearch-7.12.0-linux-x86_64.tar.gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("增加elasticSearch用户")])])]),s._v(" "),t("p",[s._v("必须创建一个非root用户来运行ElasticSearch(ElasticSearch5及以上版本，基于安全考虑，强制规定不能以root身份运行。)")]),s._v(" "),t("p",[s._v("如果你使用root用户来启动ElasticSearch，则会有如下错误信息：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd elasticsearch-7.12.0/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos elasticsearch-7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./bin/elasticsearch")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-04-05T21:36:46,510"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("o.e.b.ElasticsearchUncaughtExceptionHandler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("VM-0-14-centos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" uncaught exception "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" thread "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\norg.elasticsearch.bootstrap.StartupException: java.lang.RuntimeException: can not run elasticsearch as root\n        at org.elasticsearch.bootstrap.Elasticsearch.init"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Elasticsearch.java:163"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch-7.12.0.jar:7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.execute"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Elasticsearch.java:150"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch-7.12.0.jar:7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        at org.elasticsearch.cli.EnvironmentAwareCommand.execute"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("EnvironmentAwareCommand.java:75"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch-7.12.0.jar:7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        at org.elasticsearch.cli.Command.mainWithoutErrorHandling"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Command.java:116"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch-cli-7.12.0.jar:7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        at org.elasticsearch.cli.Command.main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Command.java:79"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch-cli-7.12.0.jar:7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Elasticsearch.java:115"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch-7.12.0.jar:7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Elasticsearch.java:81"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch-7.12.0.jar:7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nCaused by: java.lang.RuntimeException: can not run elasticsearch as root\n        at org.elasticsearch.bootstrap.Bootstrap.initializeNatives"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Bootstrap.java:101"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch-7.12.0.jar:7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        at org.elasticsearch.bootstrap.Bootstrap.setup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Bootstrap.java:168"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch-7.12.0.jar:7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        at org.elasticsearch.bootstrap.Bootstrap.init"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Bootstrap.java:397"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch-7.12.0.jar:7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.init"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Elasticsearch.java:159"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch-7.12.0.jar:7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v("\nuncaught exception "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" thread "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\njava.lang.RuntimeException: can not run elasticsearch as root\n        at org.elasticsearch.bootstrap.Bootstrap.initializeNatives"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Bootstrap.java:101"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at org.elasticsearch.bootstrap.Bootstrap.setup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Bootstrap.java:168"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at org.elasticsearch.bootstrap.Bootstrap.init"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Bootstrap.java:397"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.init"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Elasticsearch.java:159"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.execute"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Elasticsearch.java:150"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at org.elasticsearch.cli.EnvironmentAwareCommand.execute"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("EnvironmentAwareCommand.java:75"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at org.elasticsearch.cli.Command.mainWithoutErrorHandling"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Command.java:116"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at org.elasticsearch.cli.Command.main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Command.java:79"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Elasticsearch.java:115"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Elasticsearch.java:81"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nFor complete error details, refer to the log at /opt/elasticsearch-7.12.0/logs/elasticsearch.log\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-04-05 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":36:46,979269 UTC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8846")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" INFO  Main.cc@106 Parent process died - ML controller exiting\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("p",[s._v("所以我们增加一个独立的elasticsearch用户来运行")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 增加elasticsearch用户")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos elasticsearch-7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# useradd elasticsearch")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos elasticsearch-7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# passwd elasticsearch")]),s._v("\nChanging password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user elasticsearch.\nNew password: \nBAD PASSWORD: The password contains the user name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" some form\nRetype new password: \npasswd: all authentication tokens updated successfully.\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改目录权限至新增的elasticsearch用户")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos elasticsearch-7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown -R elasticsearch /opt/elasticsearch-7.12.0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 增加data和log存放区，并赋予elasticsearch用户权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos elasticsearch-7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir -p /data/es")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos elasticsearch-7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown -R elasticsearch /data/es")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos elasticsearch-7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir -p /var/log/es")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos elasticsearch-7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown -R elasticsearch /var/log/es")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("然后修改上述的data和log路径，"),t("code",[s._v("vi /opt/elasticsearch-7.12.0/config/elasticsearch.yml")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ----------------------------------- Paths ------------------------------------")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Path to directory where to store the data (separate multiple locations by comma):")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\npath.data: /data/es\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Path to log files:")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\npath.logs: /var/log/es\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("修改Linux系统的限制配置")])])]),s._v(" "),t("ol",[t("li",[s._v("修改系统中允许应用最多创建多少文件等的限制权限。Linux默认来说，一般限制应用最多创建的文件是65535个。但是ES至少需要65536的文件创建权限。")]),s._v(" "),t("li",[s._v("修改系统中允许用户启动的进程开启多少个线程。默认的Linux限制root用户开启的进程可以开启任意数量的线程，其他用户开启的进程可以开启1024个线程。必须修改限制数为4096+。因为ES至少需要4096的线程池预备。ES在5.x版本之后，强制要求在linux中不能使用root用户启动ES进程。所以必须使用其他用户启动ES进程才可以。")]),s._v(" "),t("li",[s._v("Linux低版本内核为线程分配的内存是128K。4.x版本的内核分配的内存更大。如果虚拟机的内存是1G，最多只能开启3000+个线程数。至少为虚拟机分配1.5G以上的内存。")])]),s._v(" "),t("p",[s._v("修改如下配置")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos elasticsearch-7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /etc/security/limits.conf")]),s._v("\n\nelasticsearch soft nofile "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v("\nelasticsearch hard nofile "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v("\nelasticsearch soft nproc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\nelasticsearch hard nproc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("启动ElasticSearch")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos elasticsearch-7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# su elasticsearch")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch@VM-0-14-centos elasticsearch-7.12.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ./bin/elasticsearch -d\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-04-05T22:03:38,332"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("o.e.n.Node               "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("VM-0-14-centos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" version"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.12")]),s._v(".0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", pid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13197")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", build"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("default/tar/78722783c38caa25a70982b5b042074cde5d3b3a/2021-03-18T06:17:15.410153305Z"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", OS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Linux/3.10.0-862.el7.x86_64/amd64"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", JVM"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("AdoptOpenJDK/OpenJDK "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("-Bit Server VM/15.0.1/15.0.1+9"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-04-05T22:03:38,348"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("o.e.n.Node               "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("VM-0-14-centos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" JVM home "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("/opt/elasticsearch-7.12.0/jdk"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", using bundled JDK "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("true"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-04-05T22:03:38,348"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("o.e.n.Node               "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("VM-0-14-centos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" JVM arguments "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-Xshare:auto, -Des.networkaddress.cache.ttl"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(", -Des.networkaddress.cache.negative.ttl"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(", -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true, -Dfile.encoding"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("UTF-8, -Djna.nosys"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true, -Dio.netty.noKeySetOptimization"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true, -Dio.netty.recycler.maxCapacityPerThread"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", -Dio.netty.allocator.numDirectArenas"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", -Dlog4j.shutdownHookEnabled"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false, -Dlog4j2.disable.jmx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true, -Djava.locale.providers"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("SPI,COMPAT, --add-opens"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("java.base/java.io"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ALL-UNNAMED, -XX:+UseG1GC, -Djava.io.tmpdir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/elasticsearch-17264135248464897093, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("data, -XX:ErrorFile"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("logs/hs_err_pid%p.log, -Xlog:gc*,gc+age"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("trace,safepoint:file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("logs/gc.log:utctime,pid,tags:filecount"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(",filesize"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("64m, -Xms1894m, -Xmx1894m, -XX:MaxDirectMemorySize"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("993001472")]),s._v(", -XX:G1HeapRegionSize"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("4m, -XX:InitiatingHeapOccupancyPercent"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(", -XX:G1ReservePercent"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(", -Des.path.home"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/elasticsearch-7.12.0, -Des.path.conf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/elasticsearch-7.12.0/config, -Des.distribution.flavor"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("default, -Des.distribution.type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tar, -Des.bundled_jdk"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("查看安装是否成功")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -ntlp | grep 9200")]),s._v("\ntcp6       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9200          :::*                    LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13549")]),s._v("/java          \ntcp6       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ::1:9200                :::*                    LISTEN      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13549")]),s._v("/java          \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl 127.0.0.1:9200")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"VM-0-14-centos"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cluster_name"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"elasticsearch"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cluster_uuid"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ihttW8b2TfWSkwf_YgPH2Q"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7.12.0"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_flavor"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_type"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tar"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_hash"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"78722783c38caa25a70982b5b042074cde5d3b3a"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_date"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2021-03-18T06:17:15.410153305Z"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_snapshot"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lucene_version"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8.8.0"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minimum_wire_compatibility_version"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6.8.0"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minimum_index_compatibility_version"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6.0.0-beta1"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tagline"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You Know, for Search"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("h2",{attrs:{id:"安装kibana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装kibana"}},[s._v("¶")]),s._v(" 安装Kibana")]),s._v(" "),t("blockquote",[t("p",[s._v("Kibana是界面化的查询数据的工具，下载时尽量下载与ElasicSearch一致的版本。")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("下载Kibana")])])]),s._v(" "),t("p",[s._v("从"),t("a",{attrs:{href:"https://www.elastic.co/cn/downloads/kibana",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),t("OutboundLink")],1),s._v("下载Kibana")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("解压")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar -vxzf kibana-7.12.0-linux-x86_64.tar.gz")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("使用elasticsearch用户权限")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown -R elasticsearch /opt/kibana-7.12.0-linux-x86_64")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置Kibana的远程访问")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /opt/kibana-7.12.0-linux-x86_64/config/kibana.yml")]),s._v("\nserver.host: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("启动")])])]),s._v(" "),t("p",[s._v("需要切换至elasticsearch用户")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-0-14-centos opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# su elasticsearch")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch@VM-0-14-centos opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/kibana-7.12.0-linux-x86_64/\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch@VM-0-14-centos kibana-7.12.0-linux-x86_64"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ./bin/kibana\n  log   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":30:22.185"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("info"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("plugins-service"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Plugin "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"osquery"')]),s._v(" is disabled.\n  log   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":30:22.283"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("warning"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("deprecation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Config key "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("monitoring.cluster_alerts.email_notifications.email_address"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" will be required "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" email notifications to work "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.0")]),s._v('."\n  log   '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":30:22.482"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("info"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("plugins-system"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Setting up "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" plugins: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("taskManager,licensing,globalSearch,globalSearchProviders,banners,code,usageCollection,xpackLegacy,telemetryCollectionManager,telemetry,telemetryCollectionXpack,kibanaUsageCollection,securityOss,share,newsfeed,mapsLegacy,kibanaLegacy,translations,legacyExport,embeddable,uiActionsEnhanced,expressions,charts,esUiShared,bfetch,data,home,observability,console,consoleExtensions,apmOss,searchprofiler,painlessLab,grokdebugger,management,indexPatternManagement,advancedSettings,fileUpload,savedObjects,visualizations,visTypeVislib,visTypeVega,visTypeTimelion,features,licenseManagement,watcher,canvas,visTypeTagcloud,visTypeTable,visTypeMetric,visTypeMarkdown,tileMap,regionMap,visTypeXy,graph,timelion,dashboard,dashboardEnhanced,visualize,visTypeTimeseries,inputControlVis,discover,discoverEnhanced,savedObjectsManagement,spaces,security,savedObjectsTagging,maps,lens,reporting,lists,encryptedSavedObjects,dashboardMode,dataEnhanced,cloud,upgradeAssistant,snapshotRestore,fleet,indexManagement,rollup,remoteClusters,crossClusterReplication,indexLifecycleManagement,enterpriseSearch,beatsManagement,transform,ingestPipelines,eventLog,actions,alerts,triggersActionsUi,stackAlerts,ml,securitySolution,case,infra,monitoring,logstash,apm,uptime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  log   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":30:22.483"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("info"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("plugins"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("taskManager"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" TaskManager is identified by the Kibana UUID: xxxxxx\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("如果是后台启动：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elasticsearch@VM-0-14-centos kibana-7.12.0-linux-x86_64"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" ./bin/kibana "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("界面访问")])])]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pdai-1257820000.cos.ap-beijing.myqcloud.com/pdai.tech/public/_images/db/es/es-install-1.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("可以导入simple data")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pdai-1257820000.cos.ap-beijing.myqcloud.com/pdai.tech/public/_images/db/es/es-install-2.png",loading:"lazy"}})]),s._v(" "),t("p",[s._v("查看数据")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pdai-1257820000.cos.ap-beijing.myqcloud.com/pdai.tech/public/_images/db/es/es-install-3.png",loading:"lazy"}})]),s._v(" "),t("h2",{attrs:{id:"配置密码访问"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置密码访问"}},[s._v("¶")]),s._v(" 配置密码访问")]),s._v(" "),t("blockquote",[t("p",[s._v("使用基本许可证时，默认情况下禁用Elasticsearch安全功能。由于我测试环境是放在公网上的，所以需要设置下密码访问。相关文档可以参考"),t("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/7.12/security-minimal-setup.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),t("OutboundLink")],1)])]),s._v(" "),t("ol",[t("li",[s._v("停止kibana和elasticsearch服务")]),s._v(" "),t("li",[s._v("将"),t("code",[s._v("xpack.security.enabled")]),s._v("设置添加到ES_PATH_CONF/elasticsearch.yml文件并将值设置为true")]),s._v(" "),t("li",[s._v("启动elasticsearch ("),t("code",[s._v("./bin/elasticsearch -d")]),s._v(")")]),s._v(" "),t("li",[s._v("执行如下密码设置器，"),t("code",[s._v("./bin/elasticsearch-setup-passwords interactive")]),s._v("来设置各个组件的密码")]),s._v(" "),t("li",[s._v("将elasticsearch.username设置添加到KIB_PATH_CONF/kibana.yml 文件并将值设置给elastic用户： "),t("code",[s._v('elasticsearch.username: "elastic"')])]),s._v(" "),t("li",[s._v("创建kibana keystore, "),t("code",[s._v("./bin/kibana-keystore create")])]),s._v(" "),t("li",[s._v("在kibana keystore 中添加密码 "),t("code",[s._v("./bin/kibana-keystore add elasticsearch.password")])]),s._v(" "),t("li",[s._v("重启kibana 服务即可 "),t("code",[s._v("nohup ./bin/kibana &")])])]),s._v(" "),t("p",[s._v("然后就可以使用密码登录了：")]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pdai-1257820000.cos.ap-beijing.myqcloud.com/pdai.tech/public/_images/db/es/es-install-4.png",loading:"lazy"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);