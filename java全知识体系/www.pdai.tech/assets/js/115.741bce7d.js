(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{580:function(a,t,e){"use strict";e.r(t);var _=e(11),v=Object(_.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"闲鱼-亿级商品结构化背后的思考和演进"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#闲鱼-亿级商品结构化背后的思考和演进"}},[a._v("¶")]),a._v(" 闲鱼: 亿级商品结构化背后的思考和演进")]),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("转载说明:")]),a._v(" "),e("ul",[e("li",[a._v("版权声明：本文为CSDN博主「闲鱼技术」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。")]),a._v(" "),e("li",[a._v("原文链接：https://blog.csdn.net/weixin_38912070/article/details/99518819")])])]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%e9%97%b2%e9%b1%bc-%e4%ba%bf%e7%ba%a7%e5%95%86%e5%93%81%e7%bb%93%e6%9e%84%e5%8c%96%e8%83%8c%e5%90%8e%e7%9a%84%e6%80%9d%e8%80%83%e5%92%8c%e6%bc%94%e8%bf%9b"}},[a._v("闲鱼: 亿级商品结构化背后的思考和演进")]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%e8%83%8c%e6%99%af"}},[a._v("背景")])]),a._v(" "),e("li",[e("a",{attrs:{href:"#%e6%96%b9%e6%a1%88%e9%80%89%e5%9e%8b"}},[a._v("方案选型")]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%e6%80%9d%e8%b7%af%e4%b8%80-%e7%a6%bb%e7%ba%bf%e5%bc%8f%e6%96%b9%e6%a1%88"}},[a._v("思路一 离线式方案")])]),a._v(" "),e("li",[e("a",{attrs:{href:"#%e6%80%9d%e8%b7%af%e4%ba%8c-%e6%89%8b%e5%8a%a8%e5%85%b3%e8%81%94%e6%96%b9%e6%a1%88"}},[a._v("思路二 手动关联方案")])]),a._v(" "),e("li",[e("a",{attrs:{href:"#%e6%96%b9%e6%a1%88%e5%af%b9%e6%af%94"}},[a._v("方案对比")])]),a._v(" "),e("li",[e("a",{attrs:{href:"#%e4%b8%9a%e5%8a%a1%e9%80%bb%e8%be%91"}},[a._v("业务逻辑")])])])]),a._v(" "),e("li",[e("a",{attrs:{href:"#%e6%9e%b6%e6%9e%84%e8%ae%be%e8%ae%a1"}},[a._v("架构设计")]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#%e6%8a%80%e6%9c%af%e6%8c%91%e6%88%98"}},[a._v("技术挑战")])]),a._v(" "),e("li",[e("a",{attrs:{href:"#%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84"}},[a._v("整体架构")])]),a._v(" "),e("li",[e("a",{attrs:{href:"#%e6%9e%b6%e6%9e%84%e7%bb%86%e8%8a%82"}},[a._v("架构细节")])]),a._v(" "),e("li",[e("a",{attrs:{href:"#%e7%ae%97%e6%b3%95%e6%9e%b6%e6%9e%84"}},[a._v("算法架构")])])])]),a._v(" "),e("li",[e("a",{attrs:{href:"#%e6%95%88%e6%9e%9c"}},[a._v("效果")])]),a._v(" "),e("li",[e("a",{attrs:{href:"#%e5%b1%95%e6%9c%9b"}},[a._v("展望")])])])])]),a._v(" "),e("h2",{attrs:{id:"背景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[a._v("¶")]),a._v(" 背景")]),a._v(" "),e("p",[a._v("闲鱼是一个典型的C2C场景的闲置交易平台，每个在闲鱼的用户都能享受到自由交易的乐趣，只要简单的输入商品名，商品价格，库存等信息就能完成一个商品的发布。充分的自由是闲鱼活力的来源，但是这对于一个电商平台来说是一个挑战。本文要说的商品结构化就是痛点之一。")]),a._v(" "),e("p",[a._v("C2C平台的商品结构化之所以难，是因为用户完成结构化的动力不足。怎样让用户以最小的成本来完成结构化，我们不能寄希望于商家后台这样很重的解决方案，我们需要的是一个简单高效灵活的解法。")]),a._v(" "),e("h2",{attrs:{id:"方案选型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#方案选型"}},[a._v("¶")]),a._v(" 方案选型")]),a._v(" "),e("p",[a._v("怎么解决? 首先我们从整个C2C商品发布的全周期做一个方案的对比分析。")]),a._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pdai-1257820000.cos.ap-beijing.myqcloud.com/pdai.tech/public/_images/arch/arch-e-goods-xianyu-1.png",loading:"lazy"}})]),a._v(" "),e("h3",{attrs:{id:"思路一-离线式方案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#思路一-离线式方案"}},[a._v("¶")]),a._v(" 思路一 离线式方案")]),a._v(" "),e("p",[a._v("改方案包括算法关联&社会化方案。算法关联方案是通过技术手段对用户发布的商品进行分析，从而进行同款的关联或是属性打标。社会化方案核心是将商品结构化包装成一个活动。这样能通过用户参与答题的方式，进行商品结构化的关联。离线方案核心的缺点是关联链路太长，数据回流慢。更为重要的问题是分析出的数据没有用户确认，无法在显示域中使用。")]),a._v(" "),e("h3",{attrs:{id:"思路二-手动关联方案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#思路二-手动关联方案"}},[a._v("¶")]),a._v(" 思路二 手动关联方案")]),a._v(" "),e("p",[a._v("这个是发布中的处理方案。这个方案可能是最为直观的方案。发布过程中，引导用户做属性打标或者同款商品的关联。这个方案的优点是简单直观。缺点同样明显：完全将成本转嫁给用户。对C卖家来说，每增加一个发布选择项，都可能导致用户流失。这个方案可以做为结构化的补充，却不是我们寻找的最优解。")]),a._v(" "),e("p",[a._v("我们的思考：我们能否在保障实时性的前提下，实现一个高效低成本的方案呢?")]),a._v(" "),e("p",[a._v("答案就是本文给出的方案——智能发布方案。如果闲鱼用户在发布阶段就能将准备发布的商品自动关联上手淘的商品库中的某个商品。该商品就能使用同款商品的若干结构化信息，商品结构的化的问题不就迎刃而解了么?")]),a._v(" "),e("h3",{attrs:{id:"方案对比"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#方案对比"}},[a._v("¶")]),a._v(" 方案对比")]),a._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pdai-1257820000.cos.ap-beijing.myqcloud.com/pdai.tech/public/_images/arch/arch-e-goods-xianyu-2.png",loading:"lazy"}})]),a._v(" "),e("p",[a._v("可见智能发布方案是一个成本和效果最为均衡的方案。")]),a._v(" "),e("h3",{attrs:{id:"业务逻辑"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#业务逻辑"}},[a._v("¶")]),a._v(" 业务逻辑")]),a._v(" "),e("p",[a._v("先从通过下图，了解一下产品核心逻辑（以视频发布为例）")]),a._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pdai-1257820000.cos.ap-beijing.myqcloud.com/pdai.tech/public/_images/arch/arch-e-goods-xianyu-3.png",loading:"lazy"}})]),a._v(" "),e("p",[a._v("简单拆解：")]),a._v(" "),e("ol",[e("li",[a._v("主体对焦")])]),a._v(" "),e("p",[a._v("作为智能识别的开始。我们需要通过AI算法识别出端侧的拍摄的主体对象。这样做的目的是跟用户对识别物体目标保持一致。")]),a._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[a._v("智能识别&引导")])]),a._v(" "),e("p",[a._v("我们会在用户拍摄过程中对被拍摄物体进行实时识别。同时我们引导用户拍摄目标对象的核心信息放大算法的效果。")]),a._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[a._v("结果反馈&用户确认")])]),a._v(" "),e("p",[a._v("当用户拍摄完成，我们会以同款的方式，让用户进行一个简单的选择。")]),a._v(" "),e("h2",{attrs:{id:"架构设计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#架构设计"}},[a._v("¶")]),a._v(" 架构设计")]),a._v(" "),e("h3",{attrs:{id:"技术挑战"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#技术挑战"}},[a._v("¶")]),a._v(" 技术挑战")]),a._v(" "),e("p",[a._v("综上智能发布的核心解法是将商品结构化的产品问题，转变成同款商品匹配这样的技术问题。")]),a._v(" "),e("p",[a._v("所以我们的核心技术挑战：")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("在发布阶段进行商品识别的实时性保障")])]),a._v(" "),e("li",[e("p",[a._v("怎样通过压榨AI的能力从而最大化同款商品的匹配成功率")])])]),a._v(" "),e("p",[a._v("从闲鱼角度解这个问题，我们有三大技术优势:")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("以AliNN为代表的移动AI解决方案使得端侧AI计算成为可能")])]),a._v(" "),e("li",[e("p",[a._v("我们有这个星球上可能最大的商品信息库(淘宝&天猫)")])]),a._v(" "),e("li",[e("p",[a._v("阿里达摩院雄厚的AI能力")])])]),a._v(" "),e("p",[a._v("我们可以通过前置部分AI能力到端侧，大幅度提升链路的实时性。同时我们将AI识别能力和淘系商品库做结合，完成同款商品匹配的功能。")]),a._v(" "),e("p",[a._v("为了做到上面的能力，我们构建了完整的智能发布技术架构。")]),a._v(" "),e("h3",{attrs:{id:"整体架构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#整体架构"}},[a._v("¶")]),a._v(" 整体架构")]),a._v(" "),e("p",[a._v("首先介绍我们的逻辑架构")]),a._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pdai-1257820000.cos.ap-beijing.myqcloud.com/pdai.tech/public/_images/arch/arch-e-goods-xianyu-4.png",loading:"lazy"}})]),a._v(" "),e("p",[a._v("整体设计上面分为三层:")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("UI 展示和交互层。核心是处理用户输入和结果反馈。")])]),a._v(" "),e("li",[e("p",[a._v("逻辑处理层。主要是控制智能识别管线的运作逻辑和子模块处理结果的分发")])]),a._v(" "),e("li",[e("p",[a._v("框架层主要是各个核心处理子模块")])])]),a._v(" "),e("h3",{attrs:{id:"架构细节"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#架构细节"}},[a._v("¶")]),a._v(" 架构细节")]),a._v(" "),e("p",[a._v("细节来说，我们通过协同flutter，java/Oc和C++三层逻辑来构建高效的识别能力。如下图所示：")]),a._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pdai-1257820000.cos.ap-beijing.myqcloud.com/pdai.tech/public/_images/arch/arch-e-goods-xianyu-5.png",loading:"lazy"}})]),a._v(" "),e("p",[a._v("主要设计考量：")]),a._v(" "),e("p",[a._v("1.充分利用不同的技术，最大化研发效能。")]),a._v(" "),e("p",[a._v("我们充分利Flutter多端一致性的优势在UI层使用Flutter进行开发。同时我们将部分共同的算法下沉到C++层。这样能大幅提升两端逻辑的复用率和一致性。")]),a._v(" "),e("p",[a._v("2.充分利用端侧的计算能力")]),a._v(" "),e("p",[a._v("模糊检测，相似度检测，主体识别，tracking这些算法都是在端侧实现的。除了充分利用端侧的计算能力外，更重要的是提升拍摄过程中的处理效率。最大化降低对网络请求的依赖。")]),a._v(" "),e("p",[a._v("通过极致的压缩算法，将最终上传的图片大小控制在10K左右。即便是4次请求也不过40K。可以说对用户流量不会构成压力。")]),a._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[a._v("管线编排系统")])]),a._v(" "),e("p",[a._v("考虑到后期系统的持续优化，对子模块的处理逻辑的调整不可避免。因此我们设计了一个灵活的管线来管理所有的处理逻辑。该管线能灵活组合java/Oc和C++的能力。并且可以方便做到子功能的顺序调整和功能增减。架构设计如下所示（以android为例）：")]),a._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pdai-1257820000.cos.ap-beijing.myqcloud.com/pdai.tech/public/_images/arch/arch-e-goods-xianyu-6.png",loading:"lazy"}})]),a._v(" "),e("ol",{attrs:{start:"4"}},[e("li",[a._v("用户隐私的保护")])]),a._v(" "),e("p",[a._v("用作识别的图片会做加密处理，将用户隐私泄露的风险降低到最小。出现在公域中的图片地址都是无法直接访问的。即便泄漏用户的隐私也可以保全。")]),a._v(" "),e("h3",{attrs:{id:"算法架构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#算法架构"}},[a._v("¶")]),a._v(" 算法架构")]),a._v(" "),e("p",[a._v("算法侧的我们也做了大量的优化。")]),a._v(" "),e("p",[a._v("智能发布的最核心算法是同款商品的匹配算法。我们将单帧的预测算法改进为多帧预测。并且我们创新性地将算法和交互做深度融合，极限压榨算法的极限能力。过程如下所示：")]),a._v(" "),e("p",[a._v("如果算法发现当前帧若不足以作出较为准确的算法预测，则将图像信息向后传递。在传递过程中，及时通过文案引导用户拍摄算法所需要的信息。依次迭代直到完整预测出商品信息。算法处理逻辑如下图所示。")]),a._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://pdai-1257820000.cos.ap-beijing.myqcloud.com/pdai.tech/public/_images/arch/arch-e-goods-xianyu-7.png",loading:"lazy"}})]),a._v(" "),e("h2",{attrs:{id:"效果"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#效果"}},[a._v("¶")]),a._v(" 效果")]),a._v(" "),e("p",[a._v("实时性处理性能：经过我们的测试，识别过程除主动提示外对用户无明显感知。用户的正常拍摄过程无掉帧等性能问题。")]),a._v(" "),e("p",[a._v("同款商品识别效果方面：总体上基于多帧识别准确度相比单帧提升约20%。")]),a._v(" "),e("p",[a._v("通过该项目我们不仅构建了闲鱼完整的对商品的实时识别能力。同时也沉淀了图片预处理，tracking等一批端计算核心算法。基于此，我们完全可以将更加实时的AI的能力赋能给更多场景（例如扫指定商品或者logo参加特定活动等）。")]),a._v(" "),e("h2",{attrs:{id:"展望"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#展望"}},[a._v("¶")]),a._v(" 展望")]),a._v(" "),e("p",[a._v("智能发布将在9月的版本中跟大家见面，欢迎大家试用、反馈。首先上线的是视频发布的部分，后续还会增加图片，活动等场景。通过智能识别的项目，我们相信一定可以不断提升闲鱼商品结构化率。")]),a._v(" "),e("p",[a._v("我们畅想的未来发布是一个高度智能化的发布。基于摄像头对商品做深层次理解，系统直接给出商品信息，结构化标签，推荐价格，甚至新旧程度等发布要素。用户所要做的仅仅就是一个确认。今天的智能发布只是我们伟大征程的第一步，我们会向着目标不断努力！")])])}),[],!1,null,null,null);t.default=v.exports}}]);